<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="astro-fortran -- Modern Fortran implementations of standard models used in fundamental astronomy">
    
    <meta name="author" content="Jacob Williams" >
    <link rel="icon" href="../favicon.png">

    <title>APIO &ndash; astro-fortran</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">astro-fortran </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../sourcefile/astro_module.f90.html">Source File</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../sourcefile/astro_module.f90.html">Source File</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>APIO
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.5% of total for procedures.">26 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/astro_module.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/astro_module.f90.html'>astro_module.f90</a></li>
    
     <li><a href='../module/astro_module.html'>astro_module</a></li>
    
  
     <li class="active">APIO</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/apio.html#src">APIO</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine APIO(sp, theta, elong, phi, hm, xp, yp, refa, refb, astrom)
    
    
   
</h2>
    
  


    
    <p>For a terrestrial observer, prepare star-independent astrometry
  parameters for transformations between CIRS and observed coordinates.
  The caller supplies the Earth orientation information and the
  refraction constants as well as the site coordinates.</p>
<p>Status:  support routine.</p>
<h3>Notes</h3>
<ol>
<li>
<p>SP, the TIO locator s', is a tiny quantity needed only by the most
     precise applications.  It can either be set to zero or predicted
     using the SOFA routine SP00.</p>
</li>
<li>
<p>The geographical coordinates are with respect to the WGS84
     reference ellipsoid.  TAKE CARE WITH THE LONGITUDE SIGN:  the
     longitude required by the present routine is east-positive
     (i.e. right-handed), in accordance with geographical convention.</p>
</li>
<li>
<p>The polar motion XP,YP can be obtained from IERS bulletins.  The
     values are the coordinates (in radians) of the Celestial
     Intermediate Pole with respect to the International Terrestrial
     Reference System (see IERS Conventions 2003), measured along the
     meridians 0 and 90 deg west respectively.  For many applications,
     XP and YP can be set to zero.</p>
<p>Internally, the polar motion is stored in a form rotated onto the
 local meridian.</p>
</li>
<li>
<p>The refraction constants REFA and REFB are for use in a
     dZ = A<em>tan(Z)+B</em>tan^3(Z) model, where Z is the observed
     (i.e. refracted) zenith distance and dZ is the amount of
     refraction.</p>
</li>
<li>
<p>It is advisable to take great care with units, as even unlikely
     values of the input parameters are accepted and processed in
     accordance with the models used.</p>
</li>
<li>
<p>In cases where the caller does not wish to provide the Earth
     rotation information and refraction constants, the routine
     APIO13 can be used instead of the present routine.  This
     starts from UTC and weather readings etc. and computes suitable
     values using other SOFA routines.</p>
</li>
<li>
<p>This is one of several routines that inserts into the ASTROM
     array star-independent parameters needed for the chain of
     astrometric transformations ICRS &lt;-&gt; GCRS &lt;-&gt; CIRS &lt;-&gt; observed.</p>
<p>The various routines support different classes of observer and
 portions of the transformation chain:</p>
<div class="codehilite"><pre><span></span><code>    <span class="n">routines</span>           <span class="n">observer</span>        <span class="n">transformation</span>

<span class="n">APCG</span> <span class="n">APCG13</span>    <span class="n">geocentric</span>      <span class="n">ICRS</span> <span class="o">&lt;-&gt;</span> <span class="n">GCRS</span>
<span class="n">APCI</span> <span class="n">APCI13</span>    <span class="n">terrestrial</span>     <span class="n">ICRS</span> <span class="o">&lt;-&gt;</span> <span class="n">CIRS</span>
<span class="n">APCO</span> <span class="n">APCO13</span>    <span class="n">terrestrial</span>     <span class="n">ICRS</span> <span class="o">&lt;-&gt;</span> <span class="n">observed</span>
<span class="n">APCS</span> <span class="n">APCS13</span>    <span class="n">space</span>           <span class="n">ICRS</span> <span class="o">&lt;-&gt;</span> <span class="n">GCRS</span>
<span class="n">APER</span> <span class="n">APER13</span>    <span class="n">terrestrial</span>     <span class="n">update</span> <span class="n">Earth</span> <span class="n">rotation</span>
<span class="n">APIO</span> <span class="n">APIO13</span>    <span class="n">terrestrial</span>     <span class="n">CIRS</span> <span class="o">&lt;-&gt;</span> <span class="n">observed</span>
</code></pre></div>

<p>Those with names ending in "13" use contemporary SOFA models to
 compute the various ephemerides.  The others accept ephemerides
 supplied by the caller.</p>
<p>The transformation from ICRS to GCRS covers space motion,
 parallax, light deflection, and aberration.  From GCRS to CIRS
 comprises frame bias and precession-nutation.  From CIRS to
 observed takes account of Earth rotation, polar motion, diurnal
 aberration and parallax (unless subsumed into the ICRS &lt;-&gt; GCRS
 transformation), and atmospheric refraction.</p>
</li>
<li>
<p>The context array ASTROM produced by this routine is used by
     ATIOQ and ATOIQ.</p>
</li>
</ol>
<h3>History</h3>
<ul>
<li>IAU SOFA revision:  2013 September 25</li>
</ul>
    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-sp~3"></span>real(kind=wp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>sp</strong></td><td><p>the TIO locator s' (radians, Note 1)</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-theta~3"></span>real(kind=wp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>theta</strong></td><td><p>Earth rotation angle (radians)</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-elong~4"></span>real(kind=wp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>elong</strong></td><td><p>longitude (radians, east +ve, Note 2)</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-phi~5"></span>real(kind=wp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>phi</strong></td><td><p>geodetic latitude (radians, Note 2)</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-hm~3"></span>real(kind=wp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>hm</strong></td><td><p>height above ellipsoid (m, geodetic Note 2)</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-xp~3"></span>real(kind=wp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>xp</strong></td><td><p>polar motion coordinate (radians, Note 3)</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-yp~3"></span>real(kind=wp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>yp</strong></td><td><p>polar motion coordinate (radians, Note 3)</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-refa~2"></span>real(kind=wp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>refa</strong></td><td><p>refraction constant A (radians, Note 4)</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-refb~2"></span>real(kind=wp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>refb</strong></td><td><p>refraction constant B (radians, Note 4)</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-astrom~11"></span>real(kind=wp),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>dimension(30)</td><td>::</td>
  <td><strong>astrom</strong></td><td><p>star-independent astrometry parameters:</p>
<p>(1)      unchanged
 (2-4)    unchanged
 (5-7)    unchanged
 (8)      unchanged
 (9-11)   unchanged
 (12)     unchanged
 (13-21)  unchanged
 (22)     longitude + s' (radians)
 (23)     polar motion xp wrt local meridian (radians)
 (24)     polar motion yp wrt local meridian (radians)
 (25)     sine of geodetic latitude
 (26)     cosine of geodetic latitude
 (27)     magnitude of diurnal aberration vector
 (28)     "local" Earth rotation angle (radians)
 (29)     refraction constant A (radians)
 (30)     refraction constant B (radians)</p></td>
  
</tr>

</tbody>
</table>

    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~apio~~CallsGraph Pages: 1 -->
<svg id="procapioCallsGraph" width="336pt" height="326pt"
 viewBox="0.00 0.00 336.00 326.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~apio~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 322)">
<title>proc~~apio~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-322 332,-322 332,4 -4,4"/>
<!-- proc~apio -->
<g id="proc~~apio~~CallsGraph_node1" class="node">
<title>proc~apio</title>
<polygon fill="none" stroke="black" points="54,-150 0,-150 0,-126 54,-126 54,-150"/>
<text text-anchor="middle" x="27" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50">APIO</text>
</g>
<!-- proc~pvtob -->
<g id="proc~~apio~~CallsGraph_node2" class="node">
<title>proc~pvtob</title>
<g id="a_proc~~apio~~CallsGraph_node2"><a xlink:href=".././proc/pvtob.html" xlink:title="PVTOB">
<polygon fill="#d9534f" stroke="#d9534f" points="144,-171 90,-171 90,-147 144,-147 144,-171"/>
<text text-anchor="middle" x="117" y="-156.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">PVTOB</text>
</a>
</g>
</g>
<!-- proc~apio&#45;&gt;proc~pvtob -->
<g id="proc~~apio~~CallsGraph_edge1" class="edge">
<title>proc~apio&#45;&gt;proc~pvtob</title>
<path fill="none" stroke="#000000" d="M54.4,-144.3C62.48,-146.23 71.51,-148.38 80.1,-150.43"/>
<polygon fill="#000000" stroke="#000000" points="79.38,-153.86 89.92,-152.78 81,-147.05 79.38,-153.86"/>
</g>
<!-- proc~aper -->
<g id="proc~~apio~~CallsGraph_node3" class="node">
<title>proc~aper</title>
<g id="a_proc~~apio~~CallsGraph_node3"><a xlink:href=".././proc/aper.html" xlink:title="APER">
<polygon fill="#d9534f" stroke="#d9534f" points="144,-129 90,-129 90,-105 144,-105 144,-129"/>
<text text-anchor="middle" x="117" y="-114.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">APER</text>
</a>
</g>
</g>
<!-- proc~apio&#45;&gt;proc~aper -->
<g id="proc~~apio~~CallsGraph_edge2" class="edge">
<title>proc~apio&#45;&gt;proc~aper</title>
<path fill="none" stroke="#000000" d="M54.4,-131.7C62.48,-129.77 71.51,-127.62 80.1,-125.57"/>
<polygon fill="#000000" stroke="#000000" points="81,-128.95 89.92,-123.22 79.38,-122.14 81,-128.95"/>
</g>
<!-- proc~trxp -->
<g id="proc~~apio~~CallsGraph_node4" class="node">
<title>proc~trxp</title>
<g id="a_proc~~apio~~CallsGraph_node4"><a xlink:href=".././proc/trxp.html" xlink:title="TRXP">
<polygon fill="#d9534f" stroke="#d9534f" points="234,-276 180,-276 180,-252 234,-252 234,-276"/>
<text text-anchor="middle" x="207" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">TRXP</text>
</a>
</g>
</g>
<!-- proc~pvtob&#45;&gt;proc~trxp -->
<g id="proc~~apio~~CallsGraph_edge3" class="edge">
<title>proc~pvtob&#45;&gt;proc~trxp</title>
<path fill="none" stroke="#000000" d="M128.09,-171.04C143,-188.83 171.08,-222.33 189.14,-243.89"/>
<polygon fill="#000000" stroke="#000000" points="186.65,-246.36 195.75,-251.77 192.01,-241.86 186.65,-246.36"/>
</g>
<!-- proc~pom00 -->
<g id="proc~~apio~~CallsGraph_node5" class="node">
<title>proc~pom00</title>
<g id="a_proc~~apio~~CallsGraph_node5"><a xlink:href=".././proc/pom00.html" xlink:title="POM00">
<polygon fill="#d9534f" stroke="#d9534f" points="234,-171 180,-171 180,-147 234,-147 234,-171"/>
<text text-anchor="middle" x="207" y="-156.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">POM00</text>
</a>
</g>
</g>
<!-- proc~pvtob&#45;&gt;proc~pom00 -->
<g id="proc~~apio~~CallsGraph_edge4" class="edge">
<title>proc~pvtob&#45;&gt;proc~pom00</title>
<path fill="none" stroke="#000000" d="M144.4,-159C152.39,-159 161.31,-159 169.82,-159"/>
<polygon fill="#000000" stroke="#000000" points="169.92,-162.5 179.92,-159 169.92,-155.5 169.92,-162.5"/>
</g>
<!-- proc~gd2gc -->
<g id="proc~~apio~~CallsGraph_node6" class="node">
<title>proc~gd2gc</title>
<g id="a_proc~~apio~~CallsGraph_node6"><a xlink:href=".././proc/gd2gc.html" xlink:title="GD2GC">
<polygon fill="#d9534f" stroke="#d9534f" points="234,-66 180,-66 180,-42 234,-42 234,-66"/>
<text text-anchor="middle" x="207" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">GD2GC</text>
</a>
</g>
</g>
<!-- proc~pvtob&#45;&gt;proc~gd2gc -->
<g id="proc~~apio~~CallsGraph_edge5" class="edge">
<title>proc~pvtob&#45;&gt;proc~gd2gc</title>
<path fill="none" stroke="#000000" d="M134.24,-146.95C137.61,-144.16 141.03,-141.1 144,-138 163,-118.15 181.24,-92.36 192.95,-74.62"/>
<polygon fill="#000000" stroke="#000000" points="195.94,-76.44 198.45,-66.15 190.07,-72.63 195.94,-76.44"/>
</g>
<!-- proc~rxp -->
<g id="proc~~apio~~CallsGraph_node9" class="node">
<title>proc~rxp</title>
<g id="a_proc~~apio~~CallsGraph_node9"><a xlink:href=".././proc/rxp.html" xlink:title="RXP">
<polygon fill="#d9534f" stroke="#d9534f" points="326,-318 272,-318 272,-294 326,-294 326,-318"/>
<text text-anchor="middle" x="299" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">RXP</text>
</a>
</g>
</g>
<!-- proc~trxp&#45;&gt;proc~rxp -->
<g id="proc~~apio~~CallsGraph_edge6" class="edge">
<title>proc~trxp&#45;&gt;proc~rxp</title>
<path fill="none" stroke="#000000" d="M234.03,-276.15C242.99,-280.33 253.17,-285.08 262.73,-289.54"/>
<polygon fill="#000000" stroke="#000000" points="261.48,-292.82 272.03,-293.88 264.45,-286.48 261.48,-292.82"/>
</g>
<!-- proc~tr -->
<g id="proc~~apio~~CallsGraph_node13" class="node">
<title>proc~tr</title>
<g id="a_proc~~apio~~CallsGraph_node13"><a xlink:href=".././proc/tr.html" xlink:title="TR">
<polygon fill="#d9534f" stroke="#d9534f" points="326,-276 272,-276 272,-252 326,-252 326,-276"/>
<text text-anchor="middle" x="299" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">TR</text>
</a>
</g>
</g>
<!-- proc~trxp&#45;&gt;proc~tr -->
<g id="proc~~apio~~CallsGraph_edge7" class="edge">
<title>proc~trxp&#45;&gt;proc~tr</title>
<path fill="none" stroke="#000000" d="M234.03,-264C242.63,-264 252.36,-264 261.59,-264"/>
<polygon fill="#000000" stroke="#000000" points="261.72,-267.5 271.71,-264 261.71,-260.5 261.72,-267.5"/>
</g>
<!-- proc~rx -->
<g id="proc~~apio~~CallsGraph_node7" class="node">
<title>proc~rx</title>
<g id="a_proc~~apio~~CallsGraph_node7"><a xlink:href=".././proc/rx.html" xlink:title="RX">
<polygon fill="#d9534f" stroke="#d9534f" points="326,-234 272,-234 272,-210 326,-210 326,-234"/>
<text text-anchor="middle" x="299" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">RX</text>
</a>
</g>
</g>
<!-- proc~pom00&#45;&gt;proc~rx -->
<g id="proc~~apio~~CallsGraph_edge9" class="edge">
<title>proc~pom00&#45;&gt;proc~rx</title>
<path fill="none" stroke="#000000" d="M225.35,-171.15C238.68,-180.47 257.28,-193.49 272.32,-204.02"/>
<polygon fill="#000000" stroke="#000000" points="270.5,-207.02 280.7,-209.89 274.52,-201.29 270.5,-207.02"/>
</g>
<!-- proc~ir -->
<g id="proc~~apio~~CallsGraph_node11" class="node">
<title>proc~ir</title>
<g id="a_proc~~apio~~CallsGraph_node11"><a xlink:href=".././proc/ir.html" xlink:title="IR">
<polygon fill="#d9534f" stroke="#d9534f" points="326,-192 272,-192 272,-168 326,-168 326,-192"/>
<text text-anchor="middle" x="299" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">IR</text>
</a>
</g>
</g>
<!-- proc~pom00&#45;&gt;proc~ir -->
<g id="proc~~apio~~CallsGraph_edge10" class="edge">
<title>proc~pom00&#45;&gt;proc~ir</title>
<path fill="none" stroke="#000000" d="M234.03,-165.07C242.72,-167.1 252.57,-169.4 261.89,-171.57"/>
<polygon fill="#000000" stroke="#000000" points="261.18,-175 271.71,-173.87 262.77,-168.19 261.18,-175"/>
</g>
<!-- proc~ry -->
<g id="proc~~apio~~CallsGraph_node12" class="node">
<title>proc~ry</title>
<g id="a_proc~~apio~~CallsGraph_node12"><a xlink:href=".././proc/ry.html" xlink:title="RY">
<polygon fill="#d9534f" stroke="#d9534f" points="326,-150 272,-150 272,-126 326,-126 326,-150"/>
<text text-anchor="middle" x="299" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">RY</text>
</a>
</g>
</g>
<!-- proc~pom00&#45;&gt;proc~ry -->
<g id="proc~~apio~~CallsGraph_edge8" class="edge">
<title>proc~pom00&#45;&gt;proc~ry</title>
<path fill="none" stroke="#000000" d="M234.03,-152.93C242.72,-150.9 252.57,-148.6 261.89,-146.43"/>
<polygon fill="#000000" stroke="#000000" points="262.77,-149.81 271.71,-144.13 261.18,-143 262.77,-149.81"/>
</g>
<!-- proc~rz -->
<g id="proc~~apio~~CallsGraph_node14" class="node">
<title>proc~rz</title>
<g id="a_proc~~apio~~CallsGraph_node14"><a xlink:href=".././proc/rz.html" xlink:title="RZ">
<polygon fill="#d9534f" stroke="#d9534f" points="326,-108 272,-108 272,-84 326,-84 326,-108"/>
<text text-anchor="middle" x="299" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">RZ</text>
</a>
</g>
</g>
<!-- proc~pom00&#45;&gt;proc~rz -->
<g id="proc~~apio~~CallsGraph_edge11" class="edge">
<title>proc~pom00&#45;&gt;proc~rz</title>
<path fill="none" stroke="#000000" d="M225.35,-146.85C238.68,-137.53 257.28,-124.51 272.32,-113.98"/>
<polygon fill="#000000" stroke="#000000" points="274.52,-116.71 280.7,-108.11 270.5,-110.98 274.52,-116.71"/>
</g>
<!-- proc~eform -->
<g id="proc~~apio~~CallsGraph_node8" class="node">
<title>proc~eform</title>
<g id="a_proc~~apio~~CallsGraph_node8"><a xlink:href=".././proc/eform.html" xlink:title="EFORM">
<polygon fill="#d9534f" stroke="#d9534f" points="326,-66 272,-66 272,-42 326,-42 326,-66"/>
<text text-anchor="middle" x="299" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">EFORM</text>
</a>
</g>
</g>
<!-- proc~gd2gc&#45;&gt;proc~eform -->
<g id="proc~~apio~~CallsGraph_edge13" class="edge">
<title>proc~gd2gc&#45;&gt;proc~eform</title>
<path fill="none" stroke="#000000" d="M234.03,-54C242.63,-54 252.36,-54 261.59,-54"/>
<polygon fill="#000000" stroke="#000000" points="261.72,-57.5 271.71,-54 261.71,-50.5 261.72,-57.5"/>
</g>
<!-- proc~gd2gce -->
<g id="proc~~apio~~CallsGraph_node10" class="node">
<title>proc~gd2gce</title>
<g id="a_proc~~apio~~CallsGraph_node10"><a xlink:href=".././proc/gd2gce.html" xlink:title="GD2GCE">
<polygon fill="#d9534f" stroke="#d9534f" points="328,-24 270,-24 270,0 328,0 328,-24"/>
<text text-anchor="middle" x="299" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">GD2GCE</text>
</a>
</g>
</g>
<!-- proc~gd2gc&#45;&gt;proc~gd2gce -->
<g id="proc~~apio~~CallsGraph_edge12" class="edge">
<title>proc~gd2gc&#45;&gt;proc~gd2gce</title>
<path fill="none" stroke="#000000" d="M234.03,-41.85C242.99,-37.67 253.17,-32.92 262.73,-28.46"/>
<polygon fill="#000000" stroke="#000000" points="264.45,-31.52 272.03,-24.12 261.48,-25.18 264.45,-31.52"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="597pt" height="32pt"
 viewBox="0.00 0.00 596.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 592.5,-28 592.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="388.5,-24 243.5,-24 243.5,0 388.5,0 388.5,-24"/>
<text text-anchor="middle" x="316" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="465,-24 407,-24 407,0 465,0 465,-24"/>
<text text-anchor="middle" x="436" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="588.5,-24 483.5,-24 483.5,0 588.5,0 588.5,-24"/>
<text text-anchor="middle" x="536" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~apio~~CalledByGraph Pages: 1 -->
<svg id="procapioCalledByGraph" width="242pt" height="74pt"
 viewBox="0.00 0.00 242.00 74.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~apio~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 70)">
<title>proc~~apio~~CalledByGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-70 238,-70 238,4 -4,4"/>
<!-- proc~apio -->
<g id="proc~~apio~~CalledByGraph_node1" class="node">
<title>proc~apio</title>
<polygon fill="none" stroke="black" points="234,-45 180,-45 180,-21 234,-21 234,-45"/>
<text text-anchor="middle" x="207" y="-30.6" font-family="Helvetica,sans-Serif" font-size="10.50">APIO</text>
</g>
<!-- proc~apio13 -->
<g id="proc~~apio~~CalledByGraph_node2" class="node">
<title>proc~apio13</title>
<g id="a_proc~~apio~~CalledByGraph_node2"><a xlink:href=".././proc/apio13.html" xlink:title="APIO13">
<polygon fill="#d9534f" stroke="#d9534f" points="144,-45 90,-45 90,-21 144,-21 144,-45"/>
<text text-anchor="middle" x="117" y="-30.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">APIO13</text>
</a>
</g>
</g>
<!-- proc~apio13&#45;&gt;proc~apio -->
<g id="proc~~apio~~CalledByGraph_edge1" class="edge">
<title>proc~apio13&#45;&gt;proc~apio</title>
<path fill="none" stroke="#000000" d="M144.4,-33C152.39,-33 161.31,-33 169.82,-33"/>
<polygon fill="#000000" stroke="#000000" points="169.92,-36.5 179.92,-33 169.92,-29.5 169.92,-36.5"/>
</g>
<!-- proc~atoi13 -->
<g id="proc~~apio~~CalledByGraph_node3" class="node">
<title>proc~atoi13</title>
<g id="a_proc~~apio~~CalledByGraph_node3"><a xlink:href=".././proc/atoi13.html" xlink:title="ATOI13">
<polygon fill="#d9534f" stroke="#d9534f" points="54,-66 0,-66 0,-42 54,-42 54,-66"/>
<text text-anchor="middle" x="27" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ATOI13</text>
</a>
</g>
</g>
<!-- proc~atoi13&#45;&gt;proc~apio13 -->
<g id="proc~~apio~~CalledByGraph_edge2" class="edge">
<title>proc~atoi13&#45;&gt;proc~apio13</title>
<path fill="none" stroke="#000000" d="M54.4,-47.7C62.48,-45.77 71.51,-43.62 80.1,-41.57"/>
<polygon fill="#000000" stroke="#000000" points="81,-44.95 89.92,-39.22 79.38,-38.14 81,-44.95"/>
</g>
<!-- proc~atio13 -->
<g id="proc~~apio~~CalledByGraph_node4" class="node">
<title>proc~atio13</title>
<g id="a_proc~~apio~~CalledByGraph_node4"><a xlink:href=".././proc/atio13.html" xlink:title="ATIO13">
<polygon fill="#d9534f" stroke="#d9534f" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ATIO13</text>
</a>
</g>
</g>
<!-- proc~atio13&#45;&gt;proc~apio13 -->
<g id="proc~~apio~~CalledByGraph_edge3" class="edge">
<title>proc~atio13&#45;&gt;proc~apio13</title>
<path fill="none" stroke="#000000" d="M54.4,-18.3C62.48,-20.23 71.51,-22.38 80.1,-24.43"/>
<polygon fill="#000000" stroke="#000000" points="79.38,-27.86 89.92,-26.78 81,-21.05 79.38,-27.86"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="597pt" height="32pt"
 viewBox="0.00 0.00 596.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 592.5,-28 592.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="388.5,-24 243.5,-24 243.5,0 388.5,0 388.5,-24"/>
<text text-anchor="middle" x="316" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="465,-24 407,-24 407,0 465,0 465,-24"/>
<text text-anchor="middle" x="436" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="588.5,-24 483.5,-24 483.5,0 588.5,0 588.5,-24"/>
<text text-anchor="middle" x="536" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/apio.html#src">APIO</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>    <span class="k">subroutine </span><span class="n">APIO</span> <span class="p">(</span> <span class="n">sp</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">elong</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">hm</span><span class="p">,</span> <span class="n">xp</span><span class="p">,</span> <span class="n">yp</span><span class="p">,</span> <span class="p">&amp;</span>
                      <span class="n">refa</span><span class="p">,</span> <span class="n">refb</span><span class="p">,</span> <span class="n">astrom</span> <span class="p">)</span>

    <span class="k">implicit none</span>

<span class="k">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">sp</span> <span class="c">!! the TIO locator s&#39; (radians, Note 1)</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">theta</span> <span class="c">!! Earth rotation angle (radians)</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">elong</span> <span class="c">!! longitude (radians, east +ve, Note 2)</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">phi</span> <span class="c">!! geodetic latitude (radians, Note 2)</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hm</span> <span class="c">!! height above ellipsoid (m, geodetic Note 2)</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">xp</span> <span class="c">!! polar motion coordinate (radians, Note 3)</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">yp</span> <span class="c">!! polar motion coordinate (radians, Note 3)</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">refa</span> <span class="c">!! refraction constant A (radians, Note 4)</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">refb</span> <span class="c">!! refraction constant B (radians, Note 4)</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">astrom</span> <span class="c">!! star-independent astrometry parameters:</span>
                                                   <span class="c">!!</span>
                                                   <span class="c">!! (1)      unchanged</span>
                                                   <span class="c">!! (2-4)    unchanged</span>
                                                   <span class="c">!! (5-7)    unchanged</span>
                                                   <span class="c">!! (8)      unchanged</span>
                                                   <span class="c">!! (9-11)   unchanged</span>
                                                   <span class="c">!! (12)     unchanged</span>
                                                   <span class="c">!! (13-21)  unchanged</span>
                                                   <span class="c">!! (22)     longitude + s&#39; (radians)</span>
                                                   <span class="c">!! (23)     polar motion xp wrt local meridian (radians)</span>
                                                   <span class="c">!! (24)     polar motion yp wrt local meridian (radians)</span>
                                                   <span class="c">!! (25)     sine of geodetic latitude</span>
                                                   <span class="c">!! (26)     cosine of geodetic latitude</span>
                                                   <span class="c">!! (27)     magnitude of diurnal aberration vector</span>
                                                   <span class="c">!! (28)     &quot;local&quot; Earth rotation angle (radians)</span>
                                                   <span class="c">!! (29)     refraction constant A (radians)</span>
                                                   <span class="c">!! (30)     refraction constant B (radians)</span>

    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">sl</span><span class="p">,</span> <span class="n">cl</span><span class="p">,</span> <span class="n">pv</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

    <span class="c">!  Longitude with adjustment for TIO locator s&#39;.</span>
    <span class="n">astrom</span><span class="p">(</span><span class="mi">22</span><span class="p">)</span> <span class="o">=</span> <span class="n">elong</span> <span class="o">+</span> <span class="n">sp</span>

    <span class="c">!  Polar motion, rotated onto the local meridian.</span>
    <span class="n">sl</span> <span class="o">=</span> <span class="nb">sin</span><span class="p">(</span><span class="n">astrom</span><span class="p">(</span><span class="mi">22</span><span class="p">))</span>
    <span class="n">cl</span> <span class="o">=</span> <span class="nb">cos</span><span class="p">(</span><span class="n">astrom</span><span class="p">(</span><span class="mi">22</span><span class="p">))</span>
    <span class="n">astrom</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span> <span class="o">=</span> <span class="n">xp</span><span class="o">*</span><span class="n">cl</span> <span class="o">-</span> <span class="n">yp</span><span class="o">*</span><span class="n">sl</span>
    <span class="n">astrom</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span> <span class="o">=</span> <span class="n">xp</span><span class="o">*</span><span class="n">sl</span> <span class="o">+</span> <span class="n">yp</span><span class="o">*</span><span class="n">cl</span>

    <span class="c">!  Functions of latitude.</span>
    <span class="n">astrom</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span> <span class="o">=</span> <span class="nb">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
    <span class="n">astrom</span><span class="p">(</span><span class="mi">26</span><span class="p">)</span> <span class="o">=</span> <span class="nb">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>

    <span class="c">!  Observer&#39;s geocentric position and velocity (m, m/s, CIRS).</span>
    <span class="k">call </span><span class="n">PVTOB</span> <span class="p">(</span> <span class="n">elong</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">hm</span><span class="p">,</span> <span class="n">xp</span><span class="p">,</span> <span class="n">yp</span><span class="p">,</span> <span class="n">sp</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">pv</span> <span class="p">)</span>

    <span class="c">!  Magnitude of diurnal aberration vector.</span>
    <span class="n">astrom</span><span class="p">(</span><span class="mi">27</span><span class="p">)</span> <span class="o">=</span> <span class="nb">sqrt</span> <span class="p">(</span> <span class="n">pv</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">pv</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">pv</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">pv</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="n">cmps</span>

    <span class="c">!  Refraction constants.</span>
    <span class="n">astrom</span><span class="p">(</span><span class="mi">29</span><span class="p">)</span> <span class="o">=</span> <span class="n">refa</span>
    <span class="n">astrom</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="o">=</span> <span class="n">refb</span>

    <span class="c">!  Local Earth rotation angle.</span>
    <span class="k">call </span><span class="n">APER</span> <span class="p">(</span> <span class="n">theta</span><span class="p">,</span> <span class="n">astrom</span> <span class="p">)</span>

    <span class="k">end subroutine </span><span class="n">APIO</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2021 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> astro-fortran was developed by Jacob Williams</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>