<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="astro-fortran -- Modern Fortran implementations of standard models used in fundamental astronomy">
    
    <meta name="author" content="Jacob Williams" >
    <link rel="icon" href="../favicon.png">

    <title>TPORS &ndash; astro-fortran</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">astro-fortran </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../sourcefile/astro_module.f90.html">Source File</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../sourcefile/astro_module.f90.html">Source File</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>TPORS
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.7% of total for procedures.">40 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/astro_module.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/astro_module.f90.html'>astro_module.f90</a></li>
    
     <li><a href='../module/astro_module.html'>astro_module</a></li>
    
  
     <li class="active">TPORS</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/tpors.html#src">TPORS</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine TPORS(xi, eta, a, b, a01, b01, a02, b02, n)
    
    
   
</h2>
    
  


    
    <p>In the tangent plane projection, given the rectangular coordinates
  of a star and its spherical coordinates, determine the spherical
  coordinates of the tangent point.</p>
<p>Status:  support routine.</p>
<h3>Notes</h3>
<ol>
<li>
<p>The tangent plane projection is also called the "gnomonic
     projection" and the "central projection".</p>
</li>
<li>
<p>The eta axis points due north in the adopted coordinate system.
     If the spherical coordinates are observed (RA,Dec), the tangent
     plane coordinates (xi,eta) are conventionally called the "standard
     coordinates".  If the spherical coordinates are with respect to a
     right-handed triad, (xi,eta) are also right-handed.  The units of
     (xi,eta) are, effectively, radians at the tangent point.</p>
</li>
<li>
<p>All angular arguments are in radians.</p>
</li>
<li>
<p>The angles A01 and A02 are returned in the range 0-2pi.  The
     angles B01 and B02 are returned in the range +/-pi, but in the
     usual, non-pole-crossing, case, the range is +/-pi/2.</p>
</li>
<li>
<p>Cases where there is no solution can arise only near the poles.
     For example, it is clearly impossible for a star at the pole
     itself to have a non-zero xi value, and hence it is meaningless
     to ask where the tangent point would have to be to bring about
     this combination of xi and dec.</p>
</li>
<li>
<p>Also near the poles, cases can arise where there are two useful
     solutions.  The returned value N indicates whether the second of
     the two solutions returned is useful;  N=1 indicates only one
     useful solution, the usual case.</p>
</li>
<li>
<p>The basis of the algorithm is to solve the spherical triangle PSC,
     where P is the north celestial pole, S is the star and C is the
     tangent point.  The spherical coordinates of the tangent point are
     [a0,b0];  writing rho^2 = (xi^2+eta^2) and r^2 = (1+rho^2), side c
     is then (pi/2-b), side p is sqrt(xi^2+eta^2) and side s (to be
     found) is (pi/2-b0).  Angle C is given by sin(C) = xi/rho and
     cos(C) = eta/rho.  Angle P (to be found) is the longitude
     difference between star and tangent point (a-a0).</p>
</li>
<li>
<p>This routine is a member of the following set:</p>
<div class="codehilite"><pre><span></span><code> <span class="nv">spherical</span>       <span class="nv">vector</span>       <span class="nv">solve</span> <span class="k">for</span>

 <span class="nv">TPXES</span>      <span class="nv">TPXEV</span>      <span class="nv">xi</span>,<span class="nv">eta</span>
 <span class="nv">TPSTS</span>      <span class="nv">TPSTV</span>       <span class="nv">star</span>
</code></pre></div>

<blockquote>
<p>TPORS &lt;    TPORV      origin</p>
</blockquote>
</li>
</ol>
<h3>References</h3>
<ul>
<li>
<p>Calabretta M.R. &amp; Greisen, E.W., 2002, "Representations of
    celestial coordinates in FITS", Astron.Astrophys. 395, 1077</p>
</li>
<li>
<p>Green, R.M., "Spherical Astronomy", Cambridge University Press,
    1987, Chapter 13.</p>
</li>
</ul>
<h3>History</h3>
<ul>
<li>IAU SOFA revision:  2018 January 2</li>
</ul>
    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-xi"></span>real(kind=wp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>xi</strong></td><td><p>rectangular coordinates of star image (Note 2)</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-eta"></span>real(kind=wp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>eta</strong></td><td><p>rectangular coordinates of star image (Note 2)</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-a~18"></span>real(kind=wp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>a</strong></td><td><p>star's spherical coordinates (Note 3)</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-b~16"></span>real(kind=wp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>b</strong></td><td><p>star's spherical coordinates (Note 3)</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-a01"></span>real(kind=wp),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>a01</strong></td><td><p>tangent point's spherical coordinates, Soln. 1</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-b01"></span>real(kind=wp),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>b01</strong></td><td><p>tangent point's spherical coordinates, Soln. 1</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-a02"></span>real(kind=wp),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>a02</strong></td><td><p>tangent point's spherical coordinates, Soln. 2</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-b02"></span>real(kind=wp),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>b02</strong></td><td><p>tangent point's spherical coordinates, Soln. 2</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-n~7"></span>integer,</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>n</strong></td><td><p>number of solutions:
 * 0 = no solutions returned (Note 5)
 * 1 = only the first solution is useful (Note 6)
 * 2 = both solutions are useful (Note 6)</p></td>
  
</tr>

</tbody>
</table>

    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~tpors~~CallsGraph Pages: 1 -->
<svg id="proctporsCallsGraph" width="152pt" height="32pt"
 viewBox="0.00 0.00 152.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~tpors~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~tpors~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 148,-28 148,4 -4,4"/>
<!-- proc~tpors -->
<g id="proc~~tpors~~CallsGraph_node1" class="node">
<title>proc~tpors</title>
<polygon fill="none" stroke="black" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">TPORS</text>
</g>
<!-- proc~anp -->
<g id="proc~~tpors~~CallsGraph_node2" class="node">
<title>proc~anp</title>
<g id="a_proc~~tpors~~CallsGraph_node2"><a xlink:href=".././proc/anp.html" xlink:title="ANP">
<polygon fill="#d94e8f" stroke="#d94e8f" points="144,-24 90,-24 90,0 144,0 144,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ANP</text>
</a>
</g>
</g>
<!-- proc~tpors&#45;&gt;proc~anp -->
<g id="proc~~tpors~~CallsGraph_edge1" class="edge">
<title>proc~tpors&#45;&gt;proc~anp</title>
<path fill="none" stroke="#000000" d="M54.4,-12C62.39,-12 71.31,-12 79.82,-12"/>
<polygon fill="#000000" stroke="#000000" points="79.92,-15.5 89.92,-12 79.92,-8.5 79.92,-15.5"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="597pt" height="32pt"
 viewBox="0.00 0.00 596.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 592.5,-28 592.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="388.5,-24 243.5,-24 243.5,0 388.5,0 388.5,-24"/>
<text text-anchor="middle" x="316" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="465,-24 407,-24 407,0 465,0 465,-24"/>
<text text-anchor="middle" x="436" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="588.5,-24 483.5,-24 483.5,0 588.5,0 588.5,-24"/>
<text text-anchor="middle" x="536" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/tpors.html#src">TPORS</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>    <span class="k">subroutine </span><span class="n">TPORS</span> <span class="p">(</span> <span class="n">xi</span><span class="p">,</span> <span class="n">eta</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">a01</span><span class="p">,</span> <span class="n">b01</span><span class="p">,</span> <span class="n">a02</span><span class="p">,</span> <span class="n">b02</span><span class="p">,</span> <span class="n">n</span> <span class="p">)</span>

    <span class="k">implicit none</span>

<span class="k">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">xi</span> <span class="c">!! rectangular coordinates of star image (Note 2)</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">eta</span> <span class="c">!! rectangular coordinates of star image (Note 2)</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">a</span> <span class="c">!! star&#39;s spherical coordinates (Note 3)</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">b</span> <span class="c">!! star&#39;s spherical coordinates (Note 3)</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">a01</span> <span class="c">!! tangent point&#39;s spherical coordinates, Soln. 1</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">b01</span> <span class="c">!! tangent point&#39;s spherical coordinates, Soln. 1</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">a02</span> <span class="c">!! tangent point&#39;s spherical coordinates, Soln. 2</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">b02</span> <span class="c">!! tangent point&#39;s spherical coordinates, Soln. 2</span>
    <span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">n</span> <span class="c">!! number of solutions:</span>
                             <span class="c">!! * 0 = no solutions returned (Note 5)</span>
                             <span class="c">!! * 1 = only the first solution is useful (Note 6)</span>
                             <span class="c">!! * 2 = both solutions are useful (Note 6)</span>

    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">xi2</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">sb</span><span class="p">,</span> <span class="n">cb</span><span class="p">,</span> <span class="n">rsb</span><span class="p">,</span> <span class="n">rcb</span><span class="p">,</span> <span class="n">w2</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">c</span>

    <span class="n">xi2</span> <span class="o">=</span> <span class="n">xi</span><span class="o">*</span><span class="n">xi</span>
    <span class="n">r</span> <span class="o">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="mf">1.0_wp</span><span class="o">+</span><span class="n">xi2</span><span class="o">+</span><span class="n">eta</span><span class="o">*</span><span class="n">eta</span><span class="p">)</span>
    <span class="n">sb</span> <span class="o">=</span> <span class="nb">sin</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="n">cb</span> <span class="o">=</span> <span class="nb">cos</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="n">rsb</span> <span class="o">=</span> <span class="n">r</span><span class="o">*</span><span class="n">sb</span>
    <span class="n">rcb</span> <span class="o">=</span> <span class="n">r</span><span class="o">*</span><span class="n">cb</span>
    <span class="n">w2</span> <span class="o">=</span> <span class="n">rcb</span><span class="o">*</span><span class="n">rcb</span> <span class="o">-</span> <span class="n">xi2</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">w2</span> <span class="o">&gt;=</span> <span class="mf">0.0_wp</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">       </span><span class="n">w</span> <span class="o">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="n">w2</span><span class="p">)</span>
       <span class="n">s</span> <span class="o">=</span> <span class="n">rsb</span> <span class="o">-</span> <span class="n">eta</span><span class="o">*</span><span class="n">w</span>
       <span class="n">c</span> <span class="o">=</span> <span class="n">rsb</span><span class="o">*</span><span class="n">eta</span> <span class="o">+</span> <span class="n">w</span>
       <span class="k">if</span> <span class="p">(</span> <span class="n">xi</span> <span class="o">==</span> <span class="mf">0.0_wp</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">w</span> <span class="o">==</span> <span class="mf">0.0_wp</span> <span class="p">)</span> <span class="n">w</span> <span class="o">=</span> <span class="mf">1.0_wp</span>
       <span class="n">a01</span> <span class="o">=</span> <span class="n">ANP</span><span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="n">atan2</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span><span class="n">w</span><span class="p">))</span>
       <span class="n">b01</span> <span class="o">=</span> <span class="n">atan2</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">c</span><span class="p">)</span>
       <span class="n">w</span> <span class="o">=</span> <span class="o">-</span><span class="n">w</span>
       <span class="n">s</span> <span class="o">=</span> <span class="n">rsb</span> <span class="o">-</span> <span class="n">eta</span><span class="o">*</span><span class="n">w</span>
       <span class="n">c</span> <span class="o">=</span> <span class="n">rsb</span><span class="o">*</span><span class="n">eta</span> <span class="o">+</span> <span class="n">w</span>
       <span class="n">a02</span> <span class="o">=</span> <span class="n">ANP</span><span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="n">atan2</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span><span class="n">w</span><span class="p">))</span>
       <span class="n">b02</span> <span class="o">=</span> <span class="n">atan2</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">c</span><span class="p">)</span>
       <span class="k">if</span> <span class="p">(</span> <span class="nb">abs</span><span class="p">(</span><span class="n">rsb</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1.0_wp</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">          </span><span class="n">n</span> <span class="o">=</span> <span class="mi">1</span>
       <span class="k">else</span>
<span class="k">          </span><span class="n">n</span> <span class="o">=</span> <span class="mi">2</span>
       <span class="k">end if</span>
<span class="k">    else</span>
<span class="k">       </span><span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">end if</span>

<span class="k">    end subroutine </span><span class="n">TPORS</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2021 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> astro-fortran was developed by Jacob Williams</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>