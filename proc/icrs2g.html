<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="astro-fortran -- Modern Fortran implementations of standard models used in fundamental astronomy">
    
    <meta name="author" content="Jacob Williams" >
    <link rel="icon" href="../favicon.png">

    <title>ICRS2G &ndash; astro-fortran</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">astro-fortran </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../sourcefile/astro_module.f90.html">Source File</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../sourcefile/astro_module.f90.html">Source File</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>ICRS2G
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.3% of total for procedures.">14 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/astro_module.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/astro_module.f90.html'>astro_module.f90</a></li>
    
     <li><a href='../module/astro_module.html'>astro_module</a></li>
    
  
     <li class="active">ICRS2G</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/icrs2g.html#src">ICRS2G</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine ICRS2G(dr, dd, dl, db)
    
    
   
</h2>
    
  


    
    <p>Transformation from ICRS to Galactic Coordinates.</p>
<p>Status:  support routine.</p>
<h3>Notes</h3>
<ol>
<li>
<p>The IAU 1958 system of Galactic coordinates was defined with
     respect to the now obsolete reference system FK4 B1950.0.  When
     interpreting the system in a modern context, several factors have
     to be taken into account:</p>
<ul>
<li>
<p>The inclusion in FK4 positions of the E-terms of aberration.</p>
</li>
<li>
<p>The distortion of the FK4 proper motion system by differential
   Galactic rotation.</p>
</li>
<li>
<p>The use of the B1950.0 equinox rather than the now-standard
   J2000.0.</p>
</li>
<li>
<p>The frame bias between ICRS and the J2000.0 mean place system.</p>
</li>
</ul>
<p>The Hipparcos Catalogue (Perryman &amp; ESA 1997) provides a rotation
 matrix that transforms directly between ICRS and Galactic
 coordinates with the above factors taken into account.  The
 matrix is derived from three angles, namely the ICRS coordinates
 of the Galactic pole and the longitude of the ascending node of
 the galactic equator on the ICRS equator.  They are given in
 degrees to five decimal places and for canonical purposes are
 regarded as exact.  In the Hipparcos Catalogue the matrix elements
 are given to 10 decimal places (about 20 microarcsec).  In the
 present SOFA routine the matrix elements have been recomputed from
 the canonical three angles and are given to 30 decimal places.</p>
</li>
<li>
<p>The inverse transformation is performed by the routine G2ICRS.</p>
</li>
</ol>
<h3>Reference</h3>
<ul>
<li>Perryman M.A.C. &amp; ESA, 1997, ESA SP-1200, The Hipparcos and Tycho
    catalogues.  Astrometric and photometric star catalogues
    derived from the ESA Hipparcos Space Astrometry Mission.  ESA
    Publications Division, Noordwijk, Netherlands.</li>
</ul>
<h3>History</h3>
<ul>
<li>IAU SOFA revision:  2015 January 9</li>
</ul>
    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-dr~4"></span>real(kind=wp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>dr</strong></td><td><p>ICRS right ascension (radians)</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-dd~4"></span>real(kind=wp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>dd</strong></td><td><p>ICRS declination (radians)</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-dl~4"></span>real(kind=wp),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>dl</strong></td><td><p>galactic longitude (radians)</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-db~4"></span>real(kind=wp),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>db</strong></td><td><p>galactic latitude (radians)</p></td>
  
</tr>

</tbody>
</table>

    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~icrs2g~~CallsGraph Pages: 1 -->
<svg id="procicrs2gCallsGraph" width="152pt" height="200pt"
 viewBox="0.00 0.00 152.00 200.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~icrs2g~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 196)">
<title>proc~~icrs2g~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-196 148,-196 148,4 -4,4"/>
<!-- proc~icrs2g -->
<g id="proc~~icrs2g~~CallsGraph_node1" class="node">
<title>proc~icrs2g</title>
<polygon fill="none" stroke="black" points="54,-108 0,-108 0,-84 54,-84 54,-108"/>
<text text-anchor="middle" x="27" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50">ICRS2G</text>
</g>
<!-- proc~rxp -->
<g id="proc~~icrs2g~~CallsGraph_node2" class="node">
<title>proc~rxp</title>
<g id="a_proc~~icrs2g~~CallsGraph_node2"><a xlink:href=".././proc/rxp.html" xlink:title="RXP">
<polygon fill="#d9534f" stroke="#d9534f" points="144,-192 90,-192 90,-168 144,-168 144,-192"/>
<text text-anchor="middle" x="117" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">RXP</text>
</a>
</g>
</g>
<!-- proc~icrs2g&#45;&gt;proc~rxp -->
<g id="proc~~icrs2g~~CallsGraph_edge1" class="edge">
<title>proc~icrs2g&#45;&gt;proc~rxp</title>
<path fill="none" stroke="#000000" d="M39.04,-108.01C51.15,-121 71.35,-142.1 90,-159 90.82,-159.74 91.66,-160.49 92.51,-161.23"/>
<polygon fill="#000000" stroke="#000000" points="90.46,-164.08 100.36,-167.85 94.97,-158.73 90.46,-164.08"/>
</g>
<!-- proc~s2c -->
<g id="proc~~icrs2g~~CallsGraph_node3" class="node">
<title>proc~s2c</title>
<g id="a_proc~~icrs2g~~CallsGraph_node3"><a xlink:href=".././proc/s2c.html" xlink:title="S2C">
<polygon fill="#d9534f" stroke="#d9534f" points="144,-150 90,-150 90,-126 144,-126 144,-150"/>
<text text-anchor="middle" x="117" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">S2C</text>
</a>
</g>
</g>
<!-- proc~icrs2g&#45;&gt;proc~s2c -->
<g id="proc~~icrs2g~~CallsGraph_edge2" class="edge">
<title>proc~icrs2g&#45;&gt;proc~s2c</title>
<path fill="none" stroke="#000000" d="M53.45,-108.15C62.21,-112.33 72.17,-117.08 81.52,-121.54"/>
<polygon fill="#000000" stroke="#000000" points="80.07,-124.73 90.6,-125.88 83.09,-118.41 80.07,-124.73"/>
</g>
<!-- proc~anpm -->
<g id="proc~~icrs2g~~CallsGraph_node4" class="node">
<title>proc~anpm</title>
<g id="a_proc~~icrs2g~~CallsGraph_node4"><a xlink:href=".././proc/anpm.html" xlink:title="ANPM">
<polygon fill="#d94e8f" stroke="#d94e8f" points="144,-108 90,-108 90,-84 144,-84 144,-108"/>
<text text-anchor="middle" x="117" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ANPM</text>
</a>
</g>
</g>
<!-- proc~icrs2g&#45;&gt;proc~anpm -->
<g id="proc~~icrs2g~~CallsGraph_edge3" class="edge">
<title>proc~icrs2g&#45;&gt;proc~anpm</title>
<path fill="none" stroke="#000000" d="M54.4,-96C62.39,-96 71.31,-96 79.82,-96"/>
<polygon fill="#000000" stroke="#000000" points="79.92,-99.5 89.92,-96 79.92,-92.5 79.92,-99.5"/>
</g>
<!-- proc~c2s -->
<g id="proc~~icrs2g~~CallsGraph_node5" class="node">
<title>proc~c2s</title>
<g id="a_proc~~icrs2g~~CallsGraph_node5"><a xlink:href=".././proc/c2s.html" xlink:title="C2S">
<polygon fill="#d9534f" stroke="#d9534f" points="144,-66 90,-66 90,-42 144,-42 144,-66"/>
<text text-anchor="middle" x="117" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">C2S</text>
</a>
</g>
</g>
<!-- proc~icrs2g&#45;&gt;proc~c2s -->
<g id="proc~~icrs2g~~CallsGraph_edge4" class="edge">
<title>proc~icrs2g&#45;&gt;proc~c2s</title>
<path fill="none" stroke="#000000" d="M53.45,-83.85C62.21,-79.67 72.17,-74.92 81.52,-70.46"/>
<polygon fill="#000000" stroke="#000000" points="83.09,-73.59 90.6,-66.12 80.07,-67.27 83.09,-73.59"/>
</g>
<!-- proc~anp -->
<g id="proc~~icrs2g~~CallsGraph_node6" class="node">
<title>proc~anp</title>
<g id="a_proc~~icrs2g~~CallsGraph_node6"><a xlink:href=".././proc/anp.html" xlink:title="ANP">
<polygon fill="#d94e8f" stroke="#d94e8f" points="144,-24 90,-24 90,0 144,0 144,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ANP</text>
</a>
</g>
</g>
<!-- proc~icrs2g&#45;&gt;proc~anp -->
<g id="proc~~icrs2g~~CallsGraph_edge5" class="edge">
<title>proc~icrs2g&#45;&gt;proc~anp</title>
<path fill="none" stroke="#000000" d="M39.04,-83.99C51.15,-71 71.35,-49.9 90,-33 90.82,-32.26 91.66,-31.51 92.51,-30.77"/>
<polygon fill="#000000" stroke="#000000" points="94.97,-33.27 100.36,-24.15 90.46,-27.92 94.97,-33.27"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="597pt" height="32pt"
 viewBox="0.00 0.00 596.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 592.5,-28 592.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="388.5,-24 243.5,-24 243.5,0 388.5,0 388.5,-24"/>
<text text-anchor="middle" x="316" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="465,-24 407,-24 407,0 465,0 465,-24"/>
<text text-anchor="middle" x="436" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="588.5,-24 483.5,-24 483.5,0 588.5,0 588.5,-24"/>
<text text-anchor="middle" x="536" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/icrs2g.html#src">ICRS2G</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>    <span class="k">subroutine </span><span class="n">ICRS2G</span> <span class="p">(</span> <span class="n">dr</span><span class="p">,</span> <span class="n">dd</span><span class="p">,</span> <span class="n">dl</span><span class="p">,</span> <span class="n">db</span> <span class="p">)</span>

    <span class="k">implicit none</span>

<span class="k">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dr</span> <span class="c">!! ICRS right ascension (radians)</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dd</span> <span class="c">!! ICRS declination (radians)</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dl</span> <span class="c">!! galactic longitude (radians)</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">db</span> <span class="c">!! galactic latitude (radians)</span>

    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="n">v1</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">v2</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

    <span class="c">!</span>
    <span class="c">!  L2,B2 system of galactic coordinates in the form presented in the</span>
    <span class="c">!  Hipparcos Catalogue.  In degrees:</span>
    <span class="c">!</span>
    <span class="c">!  P = 192.85948    right ascension of the Galactic north pole in ICRS</span>
    <span class="c">!  Q =  27.12825    declination of the Galactic north pole in ICRS</span>
    <span class="c">!  R =  32.93192    longitude of the ascending node of the Galactic</span>
    <span class="c">!                   plane on the ICRS equator</span>
    <span class="c">!</span>
    <span class="c">!  ICRS to galactic rotation matrix, obtained by computing</span>
    <span class="c">!  R_3(-R) R_1(pi/2-Q) R_3(pi/2+P) to the full precision shown:</span>
    <span class="c">!</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="k">parameter</span> <span class="kd">::</span> <span class="n">r</span> <span class="o">=</span> <span class="nb">transpose</span><span class="p">(</span><span class="nb">reshape</span><span class="p">([&amp;</span>
        <span class="o">-</span><span class="mf">0.054875560416215368492398900454_wp</span><span class="p">,</span> <span class="p">&amp;</span>
        <span class="o">-</span><span class="mf">0.873437090234885048760383168409_wp</span><span class="p">,</span> <span class="p">&amp;</span>
        <span class="o">-</span><span class="mf">0.483835015548713226831774175116_wp</span><span class="p">,</span> <span class="p">&amp;</span>
        <span class="o">+</span><span class="mf">0.494109427875583673525222371358_wp</span><span class="p">,</span> <span class="p">&amp;</span>
        <span class="o">-</span><span class="mf">0.444829629960011178146614061616_wp</span><span class="p">,</span> <span class="p">&amp;</span>
        <span class="o">+</span><span class="mf">0.746982244497218890527388004556_wp</span><span class="p">,</span> <span class="p">&amp;</span>
        <span class="o">-</span><span class="mf">0.867666149019004701181616534570_wp</span><span class="p">,</span> <span class="p">&amp;</span>
        <span class="o">-</span><span class="mf">0.198076373431201528180486091412_wp</span><span class="p">,</span> <span class="p">&amp;</span>
        <span class="o">+</span><span class="mf">0.455983776175066922272100478348_wp</span> <span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">]))</span>

    <span class="c">!  Spherical to Cartesian.</span>
    <span class="k">call </span><span class="n">S2C</span> <span class="p">(</span> <span class="n">dr</span><span class="p">,</span> <span class="n">dd</span><span class="p">,</span> <span class="n">v1</span> <span class="p">)</span>

    <span class="c">!  ICRS to Galactic.</span>
    <span class="k">call </span><span class="n">RXP</span> <span class="p">(</span> <span class="n">r</span><span class="p">,</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span> <span class="p">)</span>

    <span class="c">!  Cartesian to spherical.</span>
    <span class="k">call </span><span class="n">C2S</span> <span class="p">(</span> <span class="n">v2</span><span class="p">,</span> <span class="n">dl</span><span class="p">,</span> <span class="n">db</span> <span class="p">)</span>

    <span class="c">!  Express in conventional ranges.</span>
    <span class="n">dl</span> <span class="o">=</span> <span class="n">ANP</span> <span class="p">(</span> <span class="n">dl</span> <span class="p">)</span>
    <span class="n">db</span> <span class="o">=</span> <span class="n">ANPM</span> <span class="p">(</span> <span class="n">db</span> <span class="p">)</span>

    <span class="k">end subroutine </span><span class="n">ICRS2G</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2021 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> astro-fortran was developed by Jacob Williams</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>